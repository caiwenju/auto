# 自动化操作工具

一个基于Python和PyQt6开发的Windows自动化操作工具，支持窗口绑定、坐标获取、步骤管理和自动化执行。

## 功能特性

### 1. 窗口绑定
- 支持选择任意可见窗口进行绑定
- 显示绑定窗口的详细信息（标题、位置、尺寸）
- 提供重新绑定和状态检查功能

### 2. 坐标获取
- 实时捕获鼠标在绑定窗口中的相对坐标
- 支持点击选择目标位置
- 显示坐标历史记录

### 3. 步骤管理
- 支持添加、编辑、删除、排序自动化步骤
- 每个步骤包含：坐标位置、执行事件、延迟时间、文本输入
- 支持的事件类型：
  - 左键单击
  - 右键单击
  - 双击
  - 输入文本

### 4. 执行控制
- 支持批量执行所有步骤
- 提供暂停、继续、停止功能
- 实时显示执行进度和状态
- 支持单步调试

## 安装要求

### 系统要求
- Windows 10/11
- Python 3.8+

### 依赖包
```bash
pip install PyQt6==6.6.1
pip install pywin32==306
pip install pynput==1.7.6
pip install psutil==5.9.6
```

或者使用requirements.txt：
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 启动程序
```bash
python main.py
```

### 2. 绑定窗口
1. 点击"选择窗口"按钮
2. 在弹出的对话框中选择要绑定的目标窗口
3. 确认绑定后，界面会显示窗口信息

### 3. 获取坐标
1. 确保已绑定窗口
2. 点击"获取坐标"按钮
3. 移动鼠标到目标位置
4. 点击左键完成坐标捕获

### 4. 添加步骤
1. 获取坐标后，点击"添加步骤"按钮
2. 在编辑对话框中设置：
   - 坐标位置（自动填入捕获的坐标）
   - 执行动作（左键、右键、双击、输入文本）
   - 延迟时间（可选）
   - 输入文本（仅在选择"输入文本"时）
3. 点击"确定"保存步骤

### 5. 执行自动化
1. 添加完所有步骤后，点击"开始执行"
2. 程序会按顺序执行所有步骤
3. 可以随时暂停、继续或停止执行

## 界面说明

### 窗口绑定区域
- **绑定状态**：显示当前绑定状态
- **选择窗口**：打开窗口选择对话框
- **窗口信息**：显示绑定窗口的详细信息

### 坐标获取区域
- **获取坐标**：开始/停止坐标捕获
- **坐标显示**：显示当前鼠标坐标
- **状态提示**：显示操作提示信息

### 步骤管理区域
- **步骤列表**：显示所有添加的步骤
- **添加步骤**：添加新的自动化步骤
- **编辑步骤**：编辑选中的步骤
- **删除步骤**：删除选中的步骤
- **清空列表**：清空所有步骤

### 执行控制区域
- **开始执行**：开始执行所有步骤
- **暂停/继续**：暂停或继续执行
- **停止**：停止执行
- **进度条**：显示执行进度
- **状态显示**：显示当前执行状态

## 注意事项

1. **权限要求**：程序需要管理员权限才能控制其他窗口
2. **窗口状态**：确保目标窗口在执行期间保持可见
3. **坐标精度**：坐标基于窗口相对位置，窗口移动会影响坐标
4. **执行速度**：建议在步骤间添加适当延迟以确保稳定性

## 技术架构

- **UI框架**：PyQt6 - 现代化跨平台GUI框架
- **窗口控制**：win32gui/win32api - Windows API接口
- **输入模拟**：pynput - 跨平台输入控制库
- **多线程**：QThread - 异步执行避免界面卡顿

## 扩展功能

### 计划中的功能
- [ ] 步骤导入/导出
- [ ] 条件判断和循环
- [ ] 图像识别定位
- [ ] 热键触发
- [ ] 定时执行
- [ ] 日志记录

### 自定义开发
程序采用模块化设计，可以轻松扩展新功能：
- `WindowManager`：窗口管理
- `CoordinateCapture`：坐标捕获
- `AutomationStep`：步骤定义
- `AutomationExecutor`：执行引擎

## 故障排除

### 常见问题

1. **无法绑定窗口**
   - 确保目标窗口可见
   - 尝试以管理员身份运行程序

2. **坐标获取失败**
   - 检查窗口是否已正确绑定
   - 确保目标窗口在前台

3. **执行失败**
   - 检查目标窗口是否仍然有效
   - 确认坐标是否在窗口范围内
   - 检查是否有其他程序干扰

4. **程序崩溃**
   - 检查Python版本兼容性
   - 确认所有依赖包已正确安装

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个工具。